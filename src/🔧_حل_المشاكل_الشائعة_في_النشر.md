# ๐ง ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ ูู ุงููุดุฑ

## ุฏููู ุงุณุชูุดุงู ูุฅุตูุงุญ ุงูุฃุฎุทุงุก

---

## ๐ซ ุงููุดููุฉ 1: `supabase: command not found`

### ุงูุฃุนุฑุงุถ:
```bash
$ supabase login
bash: supabase: command not found
```

### ุงูุฃุณุจุงุจ:
- Supabase CLI ุบูุฑ ูุซุจุช
- ุงููุณุงุฑ (PATH) ุบูุฑ ูุถุจูุท

### ุงูุญู:

#### ุงูุทุฑููุฉ 1 (NPM):
```bash
npm install -g supabase
```

#### ุงูุทุฑููุฉ 2 (ุฅุฐุง ูู ุชุนูู ุงูุฃููู):
```bash
# ุนูู Windows (PowerShell ูู Administrator)
npm install -g supabase --force

# ุนูู Mac/Linux
sudo npm install -g supabase
```

#### ุงูุชุญูู:
```bash
supabase --version
```

---

## ๐ซ ุงููุดููุฉ 2: `Error: Project not linked`

### ุงูุฃุนุฑุงุถ:
```bash
$ supabase functions deploy server
Error: Project not linked
```

### ุงูุญู:

#### ุงูุฎุทูุฉ 1: ุชุณุฌูู ุงูุฏุฎูู
```bash
supabase login
```

#### ุงูุฎุทูุฉ 2: ุงูุญุตูู ุนูู Project ID
```bash
supabase projects list
```

ุฃู ูู Supabase Dashboard:
- Settings โ General โ Reference ID

#### ุงูุฎุทูุฉ 3: ุฑุจุท ุงููุดุฑูุน
```bash
supabase link --project-ref YOUR_PROJECT_ID
```

---

## ๐ซ ุงููุดููุฉ 3: ุงูุฃุฑูุงู ุชุธูุฑ "0" ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ

### ุงูุฃุนุฑุงุถ:
```
๐ฅ 0 ุทุงูุจ ูุดุท
๐จโ๐ซ 0 ุนุถู ููุฆุฉ ุชุฏุฑูุณ
๐ 0 ููุฑุฑ ุฏุฑุงุณู
```

### ุงูุณุจุจ ุงููุญุชูู 1: ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุฑุบุฉ

#### ุงูุชุญูู:
ูู Supabase SQL Editor:
```sql
SELECT COUNT(*) FROM profiles WHERE role = 'student';
SELECT COUNT(*) FROM profiles WHERE role = 'instructor';
SELECT COUNT(*) FROM courses;
```

ุฅุฐุง ูุงูุช ุงููุชุงุฆุฌ 0ุ ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุฑุบุฉ.

#### ุงูุญู:
ุฃุถู ุจูุงูุงุช ุชุฌุฑูุจูุฉ:
```sql
-- ุฅุถุงูุฉ ูุฏุฑุณ
INSERT INTO profiles (id, email, full_name, role)
VALUES (gen_random_uuid(), 'teacher@kku.edu.sa', 'ุฏ. ูุญูุฏ', 'instructor');

-- ุฅุถุงูุฉ ุทูุงุจ
INSERT INTO profiles (id, email, full_name, role, university_id)
VALUES 
  (gen_random_uuid(), 'student1@kku.edu.sa', 'ุฃุญูุฏ', 'student', '441234567'),
  (gen_random_uuid(), 'student2@kku.edu.sa', 'ุฎุงูุฏ', 'student', '441234568');

-- ุฅุถุงูุฉ ููุฑุฑ
INSERT INTO courses (course_name, course_code, instructor_id)
SELECT 'ุจุฑูุฌุฉ ุงูููุจ', 'CS301', id FROM profiles WHERE role = 'instructor' LIMIT 1;
```

### ุงูุณุจุจ ุงููุญุชูู 2: Edge Functions ุบูุฑ ููุดูุฑุฉ

#### ุงูุชุญูู:
```bash
curl https://YOUR_PROJECT_ID.supabase.co/functions/v1/make-server-90ad488b/health
```

ุฅุฐุง ุธูุฑ ุฎุทุฃ 404ุ ูุงูู Functions ุบูุฑ ููุดูุฑุฉ.

#### ุงูุญู:
```bash
supabase functions deploy server
```

### ุงูุณุจุจ ุงููุญุชูู 3: ุงูุฌุฏุงูู ุบูุฑ ููุฌูุฏุฉ

#### ุงูุชุญูู:
ูู Supabase SQL Editor:
```sql
SELECT tablename FROM pg_tables WHERE schemaname = 'public';
```

ุฅุฐุง ูู ุชุธูุฑ ุฌุฏุงูู `profiles`, `courses`, etc.ุ ูุงูู schema ูู ููููุฐ.

#### ุงูุญู:
ูููุฐ `/database_schema.sql` ูู SQL Editor.

---

## ๐ซ ุงููุดููุฉ 4: `CORS Error` ูู Console

### ุงูุฃุนุฑุงุถ:
```
Access to fetch at 'https://...' has been blocked by CORS policy
```

### ุงูุฃุณุจุงุจ:
- Edge Functions ูู ุชููุดุฑ
- CORS headers ุบูุฑ ููุฌูุฏุฉ (ููู ููุฌูุฏุฉ ูู ููุฏูุง)

### ุงูุญู:

#### ุงูุฎุทูุฉ 1: ุชุฃูุฏ ูู ูุดุฑ Edge Functions
```bash
supabase functions deploy server
```

#### ุงูุฎุทูุฉ 2: ุชุญูู ูู Logs
```bash
supabase functions logs server
```

#### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ูุจุงุดุฑ
```bash
curl -X GET https://YOUR_PROJECT_ID.supabase.co/functions/v1/make-server-90ad488b/stats/public
```

---

## ๐ซ ุงููุดููุฉ 5: `git push` ูุทูุจ username ูpassword

### ุงูุฃุนุฑุงุถ:
```bash
$ git push
Username for 'https://github.com':
Password for 'https://...':
```

ูุงูู password ูุง ูุนูู (ูุฑูุถ ุฏุงุฆูุงู).

### ุงูุณุจุจ:
GitHub ุฃูุบู ุฏุนู password authenticationุ ูุฌุจ ุงุณุชุฎุฏุงู Personal Access Token.

### ุงูุญู:

#### ุงูุฎุทูุฉ 1: ุฅูุดุงุก Personal Access Token
1. ุงุฐูุจ ุฅูู [github.com/settings/tokens](https://github.com/settings/tokens)
2. ุงุถุบุท **Generate new token** โ **Generate new token (classic)**
3. ุงุฎุชุฑ ุงุณู: `KKU Attendance Deployment`
4. ุงุฎุชุฑ Expiration: `90 days` ุฃู `No expiration`
5. ุงุฎุชุฑ permissions:
   - โ `repo` (ูู ุงูุฎูุงุฑุงุช)
6. ุงุถุบุท **Generate token**
7. **ุงูุณุฎ ุงูู token ููุฑุงู!** (ูู ุชุฑุงู ูุฑุฉ ุฃุฎุฑู)

#### ุงูุฎุทูุฉ 2: ุงุณุชุฎุฏุงู Token ุจุฏูุงู ูู Password
```bash
Username: YOUR_GITHUB_USERNAME
Password: [ุงูุตู ุงูู Token ููุง]
```

#### ุงูุฎุทูุฉ 3 (ุงุฎุชูุงุฑู): ุญูุธ Credentials
```bash
git config --global credential.helper store
```

ุงูุขู ูู ูุทูุจ ููู username/password ูุฑุฉ ุฃุฎุฑู.

---

## ๐ซ ุงููุดููุฉ 6: Vercel Build Failed

### ุงูุฃุนุฑุงุถ:
ูู Vercel Dashboard:
```
Build failed
Error: Command "npm run build" exited with 1
```

### ุงูุณุจุจ ุงููุญุชูู 1: Environment Variables ููููุฏุฉ

#### ุงูุญู:
1. ุงุฐูุจ ุฅูู Vercel โ Settings โ Environment Variables
2. ุฃุถู:
   - `VITE_SUPABASE_URL`
   - `VITE_SUPABASE_ANON_KEY`
3. **Redeploy**

### ุงูุณุจุจ ุงููุญุชูู 2: ุฃุฎุทุงุก ูู ุงูููุฏ

#### ุงูุชุญูู:
ูู ูุฌูุฏ ุงููุดุฑูุน ุงููุญูู:
```bash
npm run build
```

ุฅุฐุง ุธูุฑุช ุฃุฎุทุงุกุ ุฃุตูุญูุง ุฃููุงู ูุจู ุงูุฑูุน.

### ุงูุณุจุจ ุงููุญุชูู 3: Node version ุบูุฑ ูุชูุงูู

#### ุงูุญู:
ูู Vercel โ Settings โ General โ Node.js Version
- ุงุฎุชุฑ: `20.x` (ุฃู ุฃุญุฏุซ)

---

## ๐ซ ุงููุดููุฉ 7: `Error: Missing environment variable SUPABASE_URL`

### ุงูุฃุนุฑุงุถ:
ูู Edge Functions logs:
```
Error: Missing environment variable SUPABASE_URL
```

### ุงูุณุจุจ:
Environment variables ุบูุฑ ูุถุจูุทุฉ ูู Supabase.

### ุงูุญู:

#### ุงูุฎุทูุฉ 1: ุงูุชุญูู ูู Variables
ูู Supabase Dashboard โ Edge Functions โ server โ Settings

ูุฌุจ ุฃู ุชุฑู:
- `SUPABASE_URL`
- `SUPABASE_ANON_KEY`
- `SUPABASE_SERVICE_ROLE_KEY`

#### ุงูุฎุทูุฉ 2: ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
ูุฐู ุงููุชุบูุฑุงุช **ุชูุถุงู ุชููุงุฆูุงู** ุจูุงุณุทุฉ Supabase.

ุฅุฐุง ูุงูุช ููููุฏุฉุ ุฃุนุฏ ูุดุฑ:
```bash
supabase functions deploy server
```

---

## ๐ซ ุงููุดููุฉ 8: `relation "profiles" does not exist`

### ุงูุฃุนุฑุงุถ:
ูู Console ุฃู Logs:
```
Error: relation "profiles" does not exist
```

### ุงูุณุจุจ:
ุงูุฌุฏุงูู ูู ุชููุดุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

### ุงูุญู:

#### ุงูุฎุทูุฉ 1: ุงูุชุญูู ูู ุงูุฌุฏุงูู
ูู Supabase SQL Editor:
```sql
SELECT tablename FROM pg_tables WHERE schemaname = 'public';
```

#### ุงูุฎุทูุฉ 2: ุฅูุดุงุก ุงูุฌุฏุงูู
ุงูุณุฎ ูุญุชูู `/database_schema.sql` ูุงูุตูู ูู SQL Editorุ ุซู ุงุถุบุท **Run**.

---

## ๐ซ ุงููุดููุฉ 9: `sign up blocked: Email domain not allowed`

### ุงูุฃุนุฑุงุถ:
ุนูุฏ ูุญุงููุฉ ุงูุชุณุฌูู:
```
Error: sign up blocked: Email domain not allowed
```

### ุงูุณุจุจ:
Supabase ูููุน ุจุนุถ domains ุงูุชุฑุงุถูุงู.

### ุงูุญู:

#### ูู Supabase Dashboard:
1. ุงุฐูุจ ุฅูู Authentication โ Email Auth
2. ุงุจุญุซ ุนู **Allowed email domains**
3. ุฃุถู: `kku.edu.sa`
4. ุงุญูุธ ุงูุชุบููุฑุงุช

---

## ๐ซ ุงููุดููุฉ 10: ุงููููุน ูุนูู ูุญููุงู ููู ูุง ูุนูู ุนูู Vercel

### ุงูุฃุนุฑุงุถ:
- `npm run dev` ูุนูู ุจุดูู ุตุญูุญ
- ููู ุนูู Vercel ูุธูุฑ ุฃุฎุทุงุก ุฃู ุตูุญุฉ ุจูุถุงุก

### ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:

#### ุงูุณุจุจ 1: Environment Variables
ุชุฃูุฏ ูู ุฅุถุงูุชูุง ูู Vercel โ Settings โ Environment Variables

#### ุงูุณุจุจ 2: Hard-coded localhost URLs
ุงุจุญุซ ูู ุงูููุฏ ุนู:
```typescript
fetch('http://localhost:54321/...')
```

ูุฌุจ ุงุณุชุจุฏุงููุง ุจู:
```typescript
fetch(`https://${projectId}.supabase.co/...`)
```

#### ุงูุณุจุจ 3: Import Paths ุฎุงุทุฆุฉ
ุชุฃูุฏ ูู ุฃู ุฌููุน imports ุชุณุชุฎุฏู `.tsx` ุฃู `.ts`:
```typescript
// โ ุตุญูุญ
import { component } from './component.tsx';

// โ ุฎุงุทุฆ (ูุฏ ูุนูู ูุญููุงู ููู ูุง ูุนูู ุนูู Vercel)
import { component } from './component';
```

---

## ๐ซ ุงููุดููุฉ 11: `Too many requests` Error

### ุงูุฃุนุฑุงุถ:
```
Error: Too many requests. Please try again later.
```

### ุงูุณุจุจ:
ุชุฌุงูุฒุช ุญุฏ ุงูุทูุจุงุช ูู ุงูุฎุทุฉ ุงููุฌุงููุฉ.

### ุงูุญู:

#### ุงูุญู ุงููุคูุช:
ุงูุชุธุฑ ุณุงุนุฉ ูุงุญุฏุฉ.

#### ุงูุญู ุงูุฏุงุฆู:
- ููู ุนุฏุฏ API calls ูู ุงูููุฏ
- ุงุณุชุฎุฏู caching
- ููุฑ ูู ุงูุชุฑููุฉ ุฅูู Paid plan ุฅุฐุง ูุงู ุงููุดุฑูุน production

---

## ๐ซ ุงููุดููุฉ 12: Database Connection Timeout

### ุงูุฃุนุฑุงุถ:
```
Error: Connection timeout
Error: could not connect to server
```

### ุงูุฃุณุจุงุจ:
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ูุถุน Pause (ุจุนุฏ ูุชุฑุฉ ุนุฏู ุงุณุชุฎุฏุงู)
- ูุดุงูู ูู ุงูุดุจูุฉ

### ุงูุญู:

#### ุงูุฎุทูุฉ 1: ุฅููุงุธ ูุงุนุฏุฉ ุงูุจูุงูุงุช
ุงูุชุญ Supabase Dashboard โ ุงุฐูุจ ุฅูู ุฃู ุตูุญุฉ ูู ุงููุดุฑูุน.

Supabase ุณุชููุธ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชููุงุฆูุงู.

#### ุงูุฎุทูุฉ 2: ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
ูู SQL Editor:
```sql
SELECT 1;
```

ูุฌุจ ุฃู ูุนูู.

---

## ๐ ุงูุฏุนู ุงูุฅุถุงูู

### ุฅุฐุง ูู ุชุญู ุงููุดููุฉ:

1. **ุชุญูู ูู Logs:**
   ```bash
   # Supabase Edge Functions Logs
   supabase functions logs server --follow
   
   # ูู Vercel
   Vercel Dashboard โ Deployments โ View Function Logs
   ```

2. **ุงุจุญุซ ุนู ุงูุฎุทุฃ:**
   - ุงูุณุฎ ุฑุณุงูุฉ ุงูุฎุทุฃ ุงููุงููุฉ
   - ุงุจุญุซ ุนููุง ูู Google
   - ุฃู ุงุจุญุซ ูู Supabase Docs

3. **ุฑุงุฌุน ุงูุชูุซูู:**
   - `/๐_ุฏููู_ุงููุดุฑ_ุงูุดุงูู_ุฎุทูุฉ_ุจุฎุทูุฉ.md`
   - `/๐_ุฏููู_ุงููุจุชุฏุฆูู_ูููุดุฑ.md`
   - [Supabase Docs](https://supabase.com/docs)
   - [Vercel Docs](https://vercel.com/docs)

4. **ุชูุงุตู ูุน ุงูุฏุนู:**
   - [Supabase Discord](https://discord.supabase.com/)
   - [Vercel Support](https://vercel.com/support)

---

## โ ูุตุงุฆุญ ูุชุฌูุจ ุงููุดุงูู

1. โ **ุชุฃูุฏ ูู ูุดุฑ Edge Functions** ูุจู ูุดุฑ Frontend
2. โ **ุฃุถู Environment Variables** ูุจู ุงููุดุฑ ุนูู Vercel
3. โ **ุงุฎุชุจุฑ ูุญููุงู** ูุจู ุงูุฑูุน ุนูู GitHub
4. โ **ุชุญูู ูู ุงูู Logs** ุจุงูุชุธุงู
5. โ **ุงุญูุธ ูุณุฎุฉ ูู ุฌููุน ุงูููุงุชูุญ** ูู ููุงู ุขูู
6. โ **ูุง ุชุฑูุน `service_role_key`** ุฅูู Frontend
7. โ **ุงุณุชุฎุฏู `.env` files** ููุชุทููุฑ ุงููุญูู
8. โ **ุงูุฑุฃ ุฑุณุงุฆู ุงูุฃุฎุทุงุก ุจุนูุงูุฉ** - ุบุงูุจุงู ุชุญุชูู ุนูู ุงูุญู

---

**๐ฏ ูุนุธู ุงููุดุงูู ุชูุญู ุจูุดุฑ Edge Functions ูุฅุถุงูุฉ Environment Variables ุจุดูู ุตุญูุญ!**
